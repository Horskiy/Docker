version: '3'

services: 
  nginx:
#    image: nginx:alpine
    build: './nginx'
    volumes:

#      - ./nginx/cert/fullchain.pem:/ets/ssl/certs/fullchain.pem
#      - ./nginx/cert/privkey.pem:/ets/ssl/certs/privkey.pem
      
#      - ./nginx/conf/nginx.conf:/etc/nginx/nginx.conf
#      - ./nginx/index.html:/usr/share/nginx/html/index.html
#      - ./nginx/conf/nginx.conf:/etc/nginx/nginx.conf
#      - ./nginx/nginx-index.html:/var/www/html/nginx-index.html
#      - ./nginx/cert/fullchain.pem:/etc/nginx/fullchain.pem
#      - ./nginx/cert/privkey.pem:/etc/nginx/privkey.pem
      - ./nginx/404.html:/usr/share/nginx/html/404.html
      - ./nginx/test_cpu.txt:/test_cpu.txt
      - ./nginx/access.log:/var/log/nginx/access.log
      - ./nginx/error.log:/var/log/nginx/error.log
      - ./nginx/music.mp3:/tmp/music.mp3     
      - ./nginx/test_log.sh:/tmp/test_log.sh
      - ./nginx/400.log:/tmp/400.log
      - ./nginx/500/log:/tmp/500/log
      - ./nginx/cat_log.log:/tmp/cat_log.log
      - ./nginx/clear_cat_log.log:/tmp/clear_cat_log.log
      - ./nginx/test_log.txt:/tmp/test_log.txt
#    command: ["bin/sh", "/tmp/test_log.sh"]

    ports:
      - 8080:80
      - 443:443
    depends_on:
      - php

  php:
    build: './php'
    ports:
      - 8081:8081
    volumes:
      - ./php/public:/var/www/html


  bash:
    build: './bash'
    command: ["bin/h", "/tmp/test_log.sh"]
    restart: always
